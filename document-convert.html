<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to Professional Document Converter</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Playfair+Display:wght@400;700&family=Source+Code+Pro&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f7fa;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: var(--primary-color);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-family: 'Playfair Display', serif;
            margin-bottom: 10px;
        }
        
        .app-description {
            opacity: 0.9;
            font-weight: 300;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            padding: 20px;
        }
        
        @media (min-width: 992px) {
            .main-content {
                flex-direction: row;
            }
        }
        
        .input-section, .output-section {
            flex: 1;
            padding: 15px;
        }
        
        .input-section {
            border-right: 1px solid #eee;
        }
        
        .section-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 10px;
            color: var(--secondary-color);
        }
        
        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: 'Roboto', sans-serif;
            resize: vertical;
            margin-bottom: 15px;
            transition: border 0.3s;
        }
        
        textarea:focus {
            border-color: var(--secondary-color);
            outline: none;
        }
        
        .controls {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group h3 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--dark-color);
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button, select {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            background: var(--secondary-color);
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button.secondary {
            background: var(--light-color);
            color: var(--dark-color);
        }
        
        button.secondary:hover {
            background: #d5dbdb;
        }
        
        button.danger {
            background: var(--accent-color);
        }
        
        button.danger:hover {
            background: #c0392b;
        }
        
        button.success {
            background: var(--success-color);
        }
        
        button.success:hover {
            background: #219955;
        }
        
        select {
            background: white;
            color: var(--dark-color);
            border: 1px solid #ddd;
        }
        
        .output-container {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            min-height: 300px;
            background: white;
            overflow-y: auto;
            max-height: 500px;
        }
        
        .output-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .output-html {
            white-space: pre-wrap;
            font-family: 'Source Code Pro', monospace;
            background: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            display: none;
        }
        
        .toggle-html {
            margin-top: 10px;
        }
        
        .status-message {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            display: none;
        }
        
        .success-message {
            background: #d5f5e3;
            color: var(--success-color);
            border: 1px solid #a3e4bc;
        }
        
        .error-message {
            background: #fadbd8;
            color: var(--accent-color);
            border: 1px solid #f5b7b1;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: var(--light-color);
            color: var(--dark-color);
            font-size: 0.9rem;
        }
        
        /* Document styling */
        .document {
            font-family: inherit;
            line-height: 1.6;
            color: #333;
        }
        
        .document.portrait {
            max-width: 8.5in;
            margin: 0 auto;
        }
        
        .document.landscape {
            max-width: 11in;
            margin: 0 auto;
        }
        
        .document h1, .document h2, .document h3 {
            font-family: 'Playfair Display', serif;
            margin: 20px 0 10px;
            color: var(--primary-color);
        }
        
        .document h1 {
            font-size: 2rem;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 5px;
        }
        
        .document h2 {
            font-size: 1.5rem;
        }
        
        .document h3 {
            font-size: 1.2rem;
        }
        
        .document p {
            margin-bottom: 15px;
        }
        
        .document ul, .document ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .document blockquote {
            border-left: 4px solid var(--secondary-color);
            padding-left: 15px;
            margin: 0 0 15px 0;
            color: #555;
            font-style: italic;
        }
        
        .document pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: 'Source Code Pro', monospace;
            margin-bottom: 15px;
        }
        
        .document code {
            font-family: 'Source Code Pro', monospace;
            background: #f5f5f5;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        
        .document table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        
        .document table, .document th, .document td {
            border: 1px solid #ddd;
        }
        
        .document th, .document td {
            padding: 10px;
            text-align: left;
        }
        
        .document th {
            background: var(--primary-color);
            color: white;
        }
        
        .document tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        .document img {
            max-width: 100%;
            height: auto;
            margin: 10px 0;
        }
        
        .document .header, .document .footer {
            text-align: center;
            padding: 10px;
            font-size: 0.9em;
            color: #777;
        }
        
        /* Loading spinner */
        .spinner {
            display: none;
            width: 40px;
            height: 40px;
            margin: 20px auto;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid var(--secondary-color);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .input-section {
                border-right: none;
                border-bottom: 1px solid #eee;
            }
            
            .output-actions {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Professional Document Converter</h1>
            <p class="app-description">Transform plain text into beautifully formatted documents with ease</p>
        </header>
        
        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title"><i class="fas fa-edit"></i> Input Text</h2>
                <textarea id="inputText" placeholder="Enter or paste your text here..."></textarea>
                
                <div class="controls">
                    <div class="control-group">
                        <h3>Document Formatting</h3>
                        <div class="button-group">
                            <button id="formatDocument" class="success"><i class="fas fa-magic"></i> Auto Format</button>
                            <button id="clearText"><i class="fas fa-trash"></i> Clear</button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <h3>Text Styling</h3>
                        <div class="button-group">
                            <select id="fontFamily">
                                <option value="'Roboto', sans-serif">Roboto</option>
                                <option value="'Playfair Display', serif">Playfair Display</option>
                                <option value="'Arial', sans-serif">Arial</option>
                                <option value="'Georgia', serif">Georgia</option>
                                <option value="'Courier New', monospace">Courier New</option>
                            </select>
                            <select id="fontSize">
                                <option value="12px">Small</option>
                                <option value="14px" selected>Medium</option>
                                <option value="16px">Large</option>
                                <option value="18px">X-Large</option>
                            </select>
                            <select id="lineHeight">
                                <option value="1.4">Compact</option>
                                <option value="1.6" selected>Normal</option>
                                <option value="1.8">Spacious</option>
                            </select>
                            <select id="textColor">
                                <option value="#333333">Black</option>
                                <option value="#2c3e50">Dark Blue</option>
                                <option value="#7f8c8d">Gray</option>
                                <option value="#c0392b">Red</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <h3>Document Structure</h3>
                        <div class="button-group">
                            <button id="addHeading"><i class="fas fa-heading"></i> Heading</button>
                            <button id="addSubheading"><i class="fas fa-heading"></i> Subheading</button>
                            <button id="addList"><i class="fas fa-list-ul"></i> List</button>
                            <button id="addTable"><i class="fas fa-table"></i> Table</button>
                            <button id="addQuote"><i class="fas fa-quote-right"></i> Quote</button>
                            <button id="addCode"><i class="fas fa-code"></i> Code</button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <h3>Page Settings</h3>
                        <div class="button-group">
                            <select id="pageOrientation">
                                <option value="portrait">Portrait</option>
                                <option value="landscape">Landscape</option>
                            </select>
                            <select id="pageSize">
                                <option value="letter">Letter (8.5x11 in)</option>
                                <option value="a4">A4 (210x297 mm)</option>
                                <option value="legal">Legal (8.5x14 in)</option>
                            </select>
                            <select id="marginSize">
                                <option value="1in">1 inch margins</option>
                                <option value="0.75in">0.75 inch margins</option>
                                <option value="0.5in" selected>0.5 inch margins</option>
                            </select>
                        </div>
                    </div>
                    
                    <button id="previewDocument" class="secondary"><i class="fas fa-eye"></i> Preview Document</button>
                </div>
            </div>
            
            <div class="output-section">
                <h2 class="section-title"><i class="fas fa-file-alt"></i> Output Preview</h2>
                <div id="statusMessage" class="status-message"></div>
                <div id="spinner" class="spinner"></div>
                <div id="outputContainer" class="output-container">
                    <p>Your formatted document will appear here...</p>
                </div>
                
                <div id="outputHtml" class="output-html"></div>
                
                <div class="output-actions">
                    <button id="copyHtml" class="secondary"><i class="fas fa-copy"></i> Copy HTML</button>
                    <button id="downloadHtml" class="secondary"><i class="fas fa-download"></i> Download HTML</button>
                    <button id="exportPdf" class="success"><i class="fas fa-file-pdf"></i> Export as PDF</button>
                </div>
                
                <button id="toggleHtml" class="toggle-html secondary"><i class="fas fa-code"></i> Show HTML Code</button>
            </div>
        </div>
        
        <footer>
            <p>Professional Document Converter - Free to use | No account required | All processing happens in your browser</p>
        </footer>
    </div>

    <!-- Include jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script>
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;
        
        document.addEventListener('DOMContentLoaded', function() {
            // DOM elements
            const inputText = document.getElementById('inputText');
            const outputContainer = document.getElementById('outputContainer');
            const outputHtml = document.getElementById('outputHtml');
            const formatDocumentBtn = document.getElementById('formatDocument');
            const clearTextBtn = document.getElementById('clearText');
            const previewDocumentBtn = document.getElementById('previewDocument');
            const copyHtmlBtn = document.getElementById('copyHtml');
            const downloadHtmlBtn = document.getElementById('downloadHtml');
            const exportPdfBtn = document.getElementById('exportPdf');
            const toggleHtmlBtn = document.getElementById('toggleHtml');
            const statusMessage = document.getElementById('statusMessage');
            const spinner = document.getElementById('spinner');
            
            // Formatting buttons
            const addHeadingBtn = document.getElementById('addHeading');
            const addSubheadingBtn = document.getElementById('addSubheading');
            const addListBtn = document.getElementById('addList');
            const addTableBtn = document.getElementById('addTable');
            const addQuoteBtn = document.getElementById('addQuote');
            const addCodeBtn = document.getElementById('addCode');
            
            // Style controls
            const fontFamily = document.getElementById('fontFamily');
            const fontSize = document.getElementById('fontSize');
            const lineHeight = document.getElementById('lineHeight');
            const textColor = document.getElementById('textColor');
            const pageOrientation = document.getElementById('pageOrientation');
            const pageSize = document.getElementById('pageSize');
            const marginSize = document.getElementById('marginSize');
            
            // Sample text for demonstration
            const sampleText = `Document Title
===

This is a sample document to demonstrate the capabilities of the Professional Document Converter.

Section 1: Introduction
---
This tool allows you to transform plain text into beautifully formatted documents with headings, lists, tables, and more.

Key Features:
- Easy to use interface
- Multiple formatting options
- Export to HTML or PDF
- No account required

Quote:
> "Simplicity is the ultimate sophistication." - Leonardo da Vinci

Code Example:
\`\`\`
function greet(name) {
    return "Hello, " + name + "!";
}
console.log(greet("World"));
\`\`\`

Table Example:
| Name       | Age | Occupation     |
|------------|-----|----------------|
| John Doe   | 32  | Web Developer  |
| Jane Smith | 28  | Graphic Designer|
`;
            
            // Insert sample text
            inputText.value = sampleText;
            
            // Event listeners
            formatDocumentBtn.addEventListener('click', autoFormatDocument);
            clearTextBtn.addEventListener('click', clearText);
            previewDocumentBtn.addEventListener('click', previewDocument);
            copyHtmlBtn.addEventListener('click', copyHtml);
            downloadHtmlBtn.addEventListener('click', downloadHtml);
            exportPdfBtn.addEventListener('click', exportPdf);
            toggleHtmlBtn.addEventListener('click', toggleHtml);
            
            // Formatting buttons
            addHeadingBtn.addEventListener('click', () => insertAtCursor('# Heading Text\n'));
            addSubheadingBtn.addEventListener('click', () => insertAtCursor('## Subheading\n'));
            addListBtn.addEventListener('click', () => insertAtCursor('- List item 1\n- List item 2\n- List item 3\n'));
            addTableBtn.addEventListener('click', () => insertAtCursor('| Header 1 | Header 2 | Header 3 |\n|----------|----------|----------|\n| Data 1   | Data 2   | Data 3   |\n| Data 4   | Data 5   | Data 6   |\n'));
            addQuoteBtn.addEventListener('click', () => insertAtCursor('> Quote text goes here\n'));
            addCodeBtn.addEventListener('click', () => insertAtCursor('```\n// Code goes here\n```\n'));
            
            // Style controls
            fontFamily.addEventListener('change', applyStyles);
            fontSize.addEventListener('change', applyStyles);
            lineHeight.addEventListener('change', applyStyles);
            textColor.addEventListener('change', applyStyles);
            pageOrientation.addEventListener('change', applyStyles);
            pageSize.addEventListener('change', applyStyles);
            marginSize.addEventListener('change', applyStyles);
            
            // Functions
            function showStatus(message, isSuccess = true) {
                statusMessage.textContent = message;
                statusMessage.className = isSuccess ? 'status-message success-message' : 'status-message error-message';
                statusMessage.style.display = 'block';
                
                setTimeout(() => {
                    statusMessage.style.display = 'none';
                }, 5000);
            }
            
            function showSpinner(show = true) {
                spinner.style.display = show ? 'block' : 'none';
            }
            
            function clearText() {
                inputText.value = '';
                outputContainer.innerHTML = '<p>Your formatted document will appear here...</p>';
                outputHtml.textContent = '';
                showStatus('Text cleared successfully.');
            }
            
            function insertAtCursor(text) {
                const startPos = inputText.selectionStart;
                const endPos = inputText.selectionEnd;
                const currentText = inputText.value;
                
                inputText.value = currentText.substring(0, startPos) + text + currentText.substring(endPos);
                
                // Set cursor position after inserted text
                inputText.selectionStart = inputText.selectionEnd = startPos + text.length;
                inputText.focus();
            }
            
            function autoFormatDocument() {
                // Simple auto-formatting logic
                let text = inputText.value;
                
                // Convert markdown-like headings to HTML
                text = text.replace(/^(.*)\n=+\n/gm, '<h1>$1</h1>\n');
                text = text.replace(/^(.*)\n-+\n/gm, '<h2>$1</h2>\n');
                
                // Convert markdown lists to HTML
                text = text.replace(/^\s*\*\s(.*)$/gm, '<li>$1</li>');
                text = text.replace(/^\s*-\s(.*)$/gm, '<li>$1</li>');
                text = text.replace(/(<li>.*<\/li>)+/g, function(match) {
                    return '<ul>' + match + '</ul>';
                });
                
                // Convert markdown blockquotes
                text = text.replace(/^>\s(.*)$/gm, '<blockquote>$1</blockquote>');
                
                // Convert markdown code blocks
                text = text.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');
                
                // Convert markdown tables
                text = text.replace(/\|(.+)\|\n\|[-:]+\|/g, function(match, headers) {
                    const headerCells = headers.split('|').map(cell => `<th>${cell.trim()}</th>`).join('');
                    return `<table><thead><tr>${headerCells}</tr></thead><tbody>`;
                });
                text = text.replace(/\|(.+)\|/g, function(match, row) {
                    const cells = row.split('|').map(cell => `<td>${cell.trim()}</td>`).join('');
                    return `<tr>${cells}</tr>`;
                });
                text = text.replace(/<\/tr>\s*<\/table>/g, '</tbody></table>');
                
                // Convert line breaks to paragraphs
                text = text.replace(/\n\n/g, '</p><p>');
                text = '<p>' + text + '</p>';
                
                inputText.value = text;
                showStatus('Document auto-formatted successfully.');
                previewDocument();
            }
            
            function previewDocument() {
                const text = inputText.value;
                
                // Create a document container with applied styles
                const docContainer = document.createElement('div');
                docContainer.className = `document ${pageOrientation.value}`;
                docContainer.style.fontFamily = fontFamily.value;
                docContainer.style.fontSize = fontSize.value;
                docContainer.style.lineHeight = lineHeight.value;
                docContainer.style.color = textColor.value;
                
                // Basic HTML sanitization and formatting
                let htmlContent = text
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/\n/g, '<br>');
                
                // More advanced formatting (simplified for this example)
                htmlContent = htmlContent
                    .replace(/&lt;h1&gt;(.*?)&lt;\/h1&gt;/g, '<h1>$1</h1>')
                    .replace(/&lt;h2&gt;(.*?)&lt;\/h2&gt;/g, '<h2>$1</h2>')
                    .replace(/&lt;h3&gt;(.*?)&lt;\/h3&gt;/g, '<h3>$1</h3>')
                    .replace(/&lt;p&gt;(.*?)&lt;\/p&gt;/g, '<p>$1</p>')
                    .replace(/&lt;ul&gt;(.*?)&lt;\/ul&gt;/g, '<ul>$1</ul>')
                    .replace(/&lt;ol&gt;(.*?)&lt;\/ol&gt;/g, '<ol>$1</ol>')
                    .replace(/&lt;li&gt;(.*?)&lt;\/li&gt;/g, '<li>$1</li>')
                    .replace(/&lt;blockquote&gt;(.*?)&lt;\/blockquote&gt;/g, '<blockquote>$1</blockquote>')
                    .replace(/&lt;pre&gt;(.*?)&lt;\/pre&gt;/g, '<pre>$1</pre>')
                    .replace(/&lt;code&gt;(.*?)&lt;\/code&gt;/g, '<code>$1</code>')
                    .replace(/&lt;table&gt;(.*?)&lt;\/table&gt;/g, '<table>$1</table>')
                    .replace(/&lt;tr&gt;(.*?)&lt;\/tr&gt;/g, '<tr>$1</tr>')
                    .replace(/&lt;th&gt;(.*?)&lt;\/th&gt;/g, '<th>$1</th>')
                    .replace(/&lt;td&gt;(.*?)&lt;\/td&gt;/g, '<td>$1</td>')
                    .replace(/&lt;img.*?src=&quot;(.*?)&quot;.*?&gt;/g, '<img src="$1">');
                
                docContainer.innerHTML = `
                    <div class="header">Document generated on ${new Date().toLocaleDateString()}</div>
                    ${htmlContent}
                    <div class="footer">Page 1</div>
                `;
                
                outputContainer.innerHTML = '';
                outputContainer.appendChild(docContainer);
                
                // Generate and display HTML code
                outputHtml.textContent = docContainer.innerHTML;
                
                showStatus('Document preview updated successfully.');
            }
            
            function applyStyles() {
                if (outputContainer.firstChild && outputContainer.firstChild.className.includes('document')) {
                    const docElement = outputContainer.firstChild;
                    docElement.className = `document ${pageOrientation.value}`;
                    docElement.style.fontFamily = fontFamily.value;
                    docElement.style.fontSize = fontSize.value;
                    docElement.style.lineHeight = lineHeight.value;
                    docElement.style.color = textColor.value;
                    
                    showStatus('Styles applied successfully.');
                }
            }
            
            function copyHtml() {
                if (!outputHtml.textContent) {
                    showStatus('No HTML to copy. Please generate a document first.', false);
                    return;
                }
                
                navigator.clipboard.writeText(outputHtml.textContent)
                    .then(() => showStatus('HTML copied to clipboard!'))
                    .catch(err => {
                        console.error('Failed to copy: ', err);
                        showStatus('Failed to copy HTML to clipboard.', false);
                    });
            }
            
            function downloadHtml() {
                if (!outputHtml.textContent) {
                    showStatus('No HTML to download. Please generate a document first.', false);
                    return;
                }
                
                const blob = new Blob([outputHtml.textContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'document.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showStatus('HTML file downloaded successfully.');
            }
            
            async function exportPdf() {
                if (!outputContainer.firstChild || !outputContainer.firstChild.className.includes('document')) {
                    showStatus('No document to export. Please generate a document first.', false);
                    return;
                }
                
                showSpinner(true);
                
                try {
                    // Create a clone of the document to avoid modifying the original
                    const element = outputContainer.firstChild.cloneNode(true);
                    
                    // Add a timestamp to the footer
                    const footer = element.querySelector('.footer');
                    if (footer) {
                        footer.textContent = `Generated on ${new Date().toLocaleString()} | Page 1`;
                    }
                    
                    // Temporary add to body for rendering
                    element.style.position = 'absolute';
                    element.style.left = '-9999px';
                    document.body.appendChild(element);
                    
                    // Use html2canvas to capture the element
                    const canvas = await html2canvas(element, {
                        scale: 2,
                        logging: false,
                        useCORS: true,
                        allowTaint: true
                    });
                    
                    // Remove the temporary element
                    document.body.removeChild(element);
                    
                    // Calculate PDF dimensions based on page size and orientation
                    let pageWidth, pageHeight;
                    const margin = marginSize.value;
                    
                    if (pageSize.value === 'a4') {
                        pageWidth = 210; // A4 width in mm
                        pageHeight = 297; // A4 height in mm
                    } else if (pageSize.value === 'legal') {
                        pageWidth = 216; // Legal width in mm
                        pageHeight = 356; // Legal height in mm
                    } else {
                        pageWidth = 216; // Letter width in mm
                        pageHeight = 279; // Letter height in mm
                    }
                    
                    if (pageOrientation.value === 'landscape') {
                        // Swap width and height for landscape
                        [pageWidth, pageHeight] = [pageHeight, pageWidth];
                    }
                    
                    // Create PDF
                    const pdf = new jsPDF({
                        orientation: pageOrientation.value,
                        unit: 'mm',
                        format: [pageWidth, pageHeight]
                    });
                    
                    // Add the image to the PDF
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = pageWidth - (parseFloat(margin) * 25.4 * 2); // Convert inches to mm
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    pdf.addImage(imgData, 'PNG', parseFloat(margin) * 25.4, parseFloat(margin) * 25.4, imgWidth, imgHeight);
                    
                    // Save the PDF
                    pdf.save('document.pdf');
                    
                    showSpinner(false);
                    showStatus('PDF exported successfully!');
                } catch (error) {
                    console.error('PDF export error:', error);
                    showSpinner(false);
                    showStatus('Failed to export PDF. Please try again.', false);
                }
            }
            
            function toggleHtml() {
                if (outputHtml.style.display === 'none' || !outputHtml.style.display) {
                    outputHtml.style.display = 'block';
                    toggleHtmlBtn.innerHTML = '<i class="fas fa-eye-slash"></i> Hide HTML Code';
                } else {
                    outputHtml.style.display = 'none';
                    toggleHtmlBtn.innerHTML = '<i class="fas fa-code"></i> Show HTML Code';
                }
            }
            
            // Initialize with a preview
            previewDocument();
        });
    </script>
</body>
</html>